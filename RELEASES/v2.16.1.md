# Release v2.16.1 - Fix Upgrade Early-Exit Skips Skill Deployment

**Release Date:** 2026-02-22
**Type:** Patch Release

## Summary

This patch release fixes a bug in `scripts/upgrade_version.sh` where the early-exit path (triggered when the installed version already matches the target version) only restarted the daemon, bypassing all file deployment steps. Projects already on v2.16.0 when skills were introduced (Plan 00061, 17 Feb 2026) could not receive skills by re-running the upgrade. The fix replaces the minimal early-exit with the full idempotent deployment sequence.

PATCH release — no handler changes, acceptance testing not required per RELEASING.md Step 8.0.

## Highlights

- **Idempotent upgrade always deploys files** — Re-running the upgrade script now correctly redeploys hook scripts, `settings.json`, `.gitignore`, slash commands, and skills regardless of whether the version actually changed

## Changes

### Fixed

- **Upgrade early-exit skips skill and slash-command deployment**: When the installed version already matched the target version, `scripts/upgrade_version.sh` would exit early after only restarting the daemon, bypassing hook script deployment, `settings.json`, `.gitignore`, slash commands, and skills deployment. Projects on v2.16.0 that had not yet received skills (introduced in Plan 00061, 17 Feb 2026) could not get skills deployed by re-running the upgrade script. Replaced the minimal early-exit path with the full idempotent deployment sequence so all deployment steps run safely regardless of whether a version change occurred.

## Upgrade Instructions

No breaking changes. Standard upgrade procedure applies.

**Option 1: Using the /hooks-daemon skill (recommended):**

```bash
/hooks-daemon upgrade
```

**Option 2: Manual upgrade:**

```bash
cd .claude/hooks-daemon
git fetch --tags
git checkout v2.16.1
untracked/venv/bin/pip install -e .
untracked/venv/bin/python -m claude_code_hooks_daemon.daemon.cli restart
```

**Option 3: Scripted upgrade:**

```bash
cd .claude/hooks-daemon
./scripts/upgrade_version.sh v2.16.1
```

## Installation

For new installations, see [CLAUDE/LLM-INSTALL.md](../CLAUDE/LLM-INSTALL.md).

## Comparison

Full diff: https://github.com/anthropics/claude-code-hooks-daemon/compare/v2.16.0...v2.16.1
