# Release v2.8.0 - Project-Level Handlers and Developer Experience

**Release Date:** 2026-02-10
**Type:** Minor Release

## Summary

Version 2.8.0 introduces first-class support for project-level custom handlers, enabling teams to create per-project hook logic alongside the library's built-in handlers. This release includes a complete developer experience toolkit with CLI commands for scaffolding, listing, and validating project handlers. It also adds new handlers (optimal config checker, hedging language detector), integrates PHP QA CI improvements, and delivers a comprehensive documentation drive with four new user guides.

## Highlights

- **Project-Level Handlers**: First-class `.claude/project_handlers/` directory with automatic loading, priority-based execution, and full integration into handler chains (Plan 00041, PR #21)
- **Developer Experience CLI**: `scaffold-project-handler`, `list-project-handlers`, `validate-project-handler` commands for rapid handler development
- **New Handlers**: Optimal config checker (SessionStart) and hedging language detector (Stop hook)
- **PHP QA CI Integration**: Enhanced PHPCS, PHPStan, and PHP-CS-Fixer handlers (PR #20)
- **Documentation Drive**: Four new user guides, updated README, improved architecture docs
- **Test Coverage**: 96.33% overall coverage with 115+ new tests

## Changes

### Added

- **Project-Level Handlers** (Plan 00041, PR #21)
  - New `.claude/project_handlers/` directory structure for event-specific handlers
  - Automatic loading and registration of project handlers alongside library handlers
  - Priority-based execution with project handlers integrated into handler chains
  - Full test coverage with comprehensive unit and integration tests

- **Project Handler CLI Commands**
  - `scaffold-project-handler` - Generate handler templates with proper structure
  - `list-project-handlers` - Discover and validate project handlers
  - `validate-project-handler` - Lint and test individual handlers

- **Project Handler Documentation**
  - `CLAUDE/PROJECT_HANDLERS.md` - Complete project handler development guide
  - `examples/project-handlers/` - Handler templates and examples for all event types

- **Optimal Config Checker Handler** (bce7fb4)
  - SessionStart handler that validates daemon configuration
  - Checks for missing or redundant handlers
  - Suggests priority optimizations
  - Validates configuration structure

- **Hedging Language Detector Handler** (62669a7)
  - Stop hook handler that identifies uncertain language patterns
  - Detects hedging phrases ("maybe", "possibly", "I think")
  - Advisory handler for improving code quality communication

- **Upgrade Detection Improvements** (Plan 00043)
  - Robust detection for broken installations (missing venv, broken symlinks, corrupted config)
  - Handles partial upgrades and installation failures
  - Improved error messages and recovery guidance

- **User Guides** (Pre-release documentation drive)
  - `docs/guides/GETTING_STARTED.md` - Installation and first-run guide
  - `docs/guides/CONFIGURATION.md` - Deep configuration reference
  - `docs/guides/HANDLER_REFERENCE.md` - Complete handler reference (50+ handlers)
  - `docs/guides/TROUBLESHOOTING.md` - 11-section troubleshooting guide

### Changed

- **Library/Plugin Separation** (Plan 00034)
  - Clear architectural boundaries between library handlers, project handlers, and plugins
  - Library handlers in `src/claude_code_hooks_daemon/handlers/`
  - Project handlers in `.claude/project_handlers/{event_type}/`
  - Plugins in `.claude/hooks-daemon/plugins/`
  - Improved modularity and maintainability

- **PHP QA CI Integration** (PR #20)
  - PHPCS handler improvements
  - PHPStan handler enhancements
  - PHP-CS-Fixer integration

- **Documentation Improvements**
  - Updated README.md with handler count (51), test count, and project overview
  - Enhanced CLAUDE.md with project handler documentation
  - Updated ARCHITECTURE.md with current handler categories and priorities
  - Fixed HANDLER_DEVELOPMENT.md priority ranges to match code

### Fixed

- **Project Handler Config Passing**: Critical bug where `project_handlers_config` wasn't passed to daemon start (28c90e2)
- **Handler Template Keys**: Use snake_case keys in scaffolded templates for consistency (a200687)
- **Nested Installation Detection**: Prevent false positives when working on hooks-daemon repo itself (075450a)
- **Dogfooding Reminder Plugin**: Restore plugin accidentally deleted in Plan 00034 (27827bd)
- **Post-Merge QA Fixes**: Resolved all QA issues from PR #20 merge (f360f87)
- **Install/Update Instructions**: Use curl-to-file pattern for more reliable downloads (2941f18)

## Upgrade Instructions

This release is backwards compatible. No breaking changes or special upgrade steps required.

**Recommended Upgrade Method**: Fetch and review the upgrade script, then run it:

```bash
# Download the upgrade script
curl -fsSL https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/scripts/upgrade.sh -o /tmp/upgrade.sh

# Review it to ensure you're comfortable with what it does
less /tmp/upgrade.sh

# Run it
bash /tmp/upgrade.sh
```

Or use the slash command (if upgrading from v2.5.0+):

```
/hooks-daemon-update
```

**Configuration Changes**: None required. The config preservation engine automatically handles config migration during upgrade.

**New Feature: Project Handlers**: After upgrading, you can create project-specific handlers:
```bash
# Scaffold a new project handler
python -m claude_code_hooks_daemon.daemon.cli scaffold-project-handler --event pre_tool_use --name my-handler

# List all project handlers
python -m claude_code_hooks_daemon.daemon.cli list-project-handlers
```

## Installation

### New Installations

```bash
cd .claude
git clone -b v2.8.0 https://github.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon.git hooks-daemon
cd hooks-daemon
python3 -m venv untracked/venv
untracked/venv/bin/pip install -e .
untracked/venv/bin/python install.py
```

**AI-Assisted Installation (Recommended)**: See [LLM-INSTALL.md](https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/CLAUDE/LLM-INSTALL.md)

### Upgrading Existing Installations

**Method 1: Fetch and Review Script (Recommended)**

```bash
# Download the upgrade script
curl -fsSL https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/scripts/upgrade.sh -o /tmp/upgrade.sh

# Review it
less /tmp/upgrade.sh

# Run it
bash /tmp/upgrade.sh
```

**Method 2: Slash Command (v2.5.0+ only)**

```
/hooks-daemon-update
```

**Method 3: Local Script**

```bash
cd .claude/hooks-daemon
git fetch --tags
git checkout v2.8.0
untracked/venv/bin/pip install -e .
bash scripts/upgrade.sh
```

**AI-Assisted Upgrade**: See [LLM-UPDATE.md](https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/CLAUDE/LLM-UPDATE.md)

## Testing

- **Tests:** 4693+ passing
- **Coverage:** 96.33% (exceeds 95% requirement)
- **Type Safety:** MyPy strict mode compliant (0 errors)
- **Security:** Bandit scan clean (0 issues)
- **Linting:** Ruff clean (0 violations)
- **Formatting:** Black compliant

## Quality Assurance

All QA checks passing:

```
========================================
QA Summary
========================================
  Magic Values        : PASSED
  Format Check        : PASSED
  Linter              : PASSED
  Type Check          : PASSED
  Tests               : PASSED
  Security Check      : PASSED

Overall Status: ALL CHECKS PASSED
```

## Contributors

This release includes contributions from:
- Edmonds Commerce Limited
- Claude Sonnet 4.5 (AI-assisted development)
- Claude Opus 4.6 (AI-assisted development)

## Breaking Changes

None. This release is fully backwards compatible with v2.7.0.

## Known Issues

None. All features fully tested and documented.

## Full Changelog

**Compare:** https://github.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/compare/v2.7.0...v2.8.0

For complete details, see [CHANGELOG.md](../CHANGELOG.md#280---2026-02-10)

---

**Installation Support**: See `CLAUDE/LLM-INSTALL.md`
**Update Guide**: See `CLAUDE/LLM-UPDATE.md`
**Architecture**: See `CLAUDE/ARCHITECTURE.md`
**Contributing**: See `CONTRIBUTING.md`
