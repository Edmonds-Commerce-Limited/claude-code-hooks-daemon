# Release v2.6.1 - Documentation and Security Improvements

**Release Date:** 2026-02-09
**Type:** Patch Release

## Summary

Version 2.6.1 is a documentation-focused patch release that clarifies the architectural separation between daemon handlers and native agent hooks, strengthens release workflow documentation to prevent manual release operations, and fixes a security issue in the v2.6.0 upgrade instructions. This release contains no code changes but significantly improves project documentation and developer guidance.

## Highlights

- **Architecture Documentation**: Comprehensive clarification of when to use daemon handlers vs native agent hooks
- **Release Workflow Warnings**: Critical documentation preventing manual release operations that bypass validation
- **Security Fix**: Upgrade instructions now use secure fetch-review-run pattern instead of curl pipe bash
- **Handler Development Guidance**: Added "When NOT to Write a Handler" section with clear decision criteria

## Changes

### Changed

- **Architecture Documentation**: Added comprehensive documentation clarifying daemon vs agent hooks separation
  - Documented when to use daemon handlers (deterministic, fast, state-free) vs native agent hooks (complex reasoning, context-aware)
  - Added "When NOT to Write a Handler" section to HANDLER_DEVELOPMENT.md with decision tree
  - Updated README.md with architectural principle explanations
  - Enhanced ARCHITECTURE.md with daemon/agent hooks distinction and trade-offs
  - Clarifies that handlers are for deterministic pattern matching, not complex analysis

- **Release Workflow Documentation**: Added critical warnings to prevent manual release operations
  - Added CRITICAL section to CLAUDE.md emphasizing mandatory /release skill usage
  - Documents why manual git tag/push operations are forbidden
  - Clarifies pre-release validation requirements (QA, git state, GitHub CLI)
  - Explains version consistency checks across all files
  - Documents Opus documentation review workflow
  - Prevents bypassing of changelog generation and proper git tagging

### Fixed

- **Upgrade Instructions Security**: Fixed v2.6.0 upgrade instructions to use fetch-review-run pattern
  - Changed from `curl ... | bash` (pipes curl output directly to shell - security risk)
  - Changed to fetch-review-run: download to temp, review, then execute
  - Aligns with project's own curl_pipe_shell blocker handler
  - Follows industry best practices (allows inspection before execution)
  - Updated CHANGELOG.md to reflect the secure upgrade pattern
  - Pattern: `curl -o /tmp/upgrade.sh && less /tmp/upgrade.sh && bash /tmp/upgrade.sh`

## Upgrade Instructions

This release is backwards compatible. No breaking changes or special upgrade steps required.

**Recommended Upgrade Method**: Fetch and review the upgrade script, then run it:

```bash
# Download the upgrade script
curl -fsSL https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/scripts/upgrade.sh -o /tmp/upgrade.sh

# Review it to ensure you're comfortable with what it does
less /tmp/upgrade.sh

# Run it
bash /tmp/upgrade.sh
```

Or use the slash command:

```
/hooks-daemon-update
```

**Configuration Changes**: None required. This release only updates documentation.

For version-specific upgrade guides, see `CLAUDE/UPGRADES/` directory.

## Installation

### New Installations

```bash
cd .claude
git clone -b v2.6.1 https://github.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon.git hooks-daemon
cd hooks-daemon
python3 -m venv untracked/venv
untracked/venv/bin/pip install -e .
untracked/venv/bin/python install.py
```

**AI-Assisted Installation (Recommended)**: See [LLM-INSTALL.md](https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/CLAUDE/LLM-INSTALL.md)

### Upgrading Existing Installations

**Method 1: Fetch and Review Script (Recommended)**

```bash
# Download the upgrade script
curl -fsSL https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/scripts/upgrade.sh -o /tmp/upgrade.sh

# Review it
less /tmp/upgrade.sh

# Run it
bash /tmp/upgrade.sh
```

**Method 2: Slash Command (v2.5.0+ only)**

```
/hooks-daemon-update
```

**Method 3: Local Script**

```bash
cd .claude/hooks-daemon
git fetch --tags
git checkout v2.6.1
untracked/venv/bin/pip install -e .
bash scripts/upgrade.sh
```

**AI-Assisted Upgrade**: See [LLM-UPDATE.md](https://raw.githubusercontent.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/main/CLAUDE/LLM-UPDATE.md)

## Testing

- **Tests:** 4297 passing
- **Coverage:** 95%+ (exceeds requirement)
- **Type Safety:** MyPy strict mode compliant (0 errors)
- **Security:** Bandit scan clean (0 issues)
- **Linting:** Ruff clean (0 violations)
- **Formatting:** Black compliant

## Quality Assurance

All QA checks passing:

```
========================================
QA Summary
========================================
  Magic Values        : ✅ PASSED
  Format Check        : ✅ PASSED
  Linter              : ✅ PASSED
  Type Check          : ✅ PASSED
  Tests               : ✅ PASSED
  Security Check      : ✅ PASSED
  Dependencies        : ✅ PASSED

Overall Status: ✅ ALL CHECKS PASSED
```

## Contributors

This release includes contributions from:
- Edmonds Commerce Limited
- Claude Sonnet 4.5 (AI-assisted development)

## Breaking Changes

None. This release is fully backwards compatible with v2.6.0.

## Deprecations

None.

## Known Issues

None.

## Full Changelog

**Compare:** https://github.com/Edmonds-Commerce-Limited/claude-code-hooks-daemon/compare/v2.6.0...v2.6.1

For complete details, see [CHANGELOG.md](../CHANGELOG.md#261---2026-02-09)
